[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "It contains lectures and exercises on Ancient DNA data analysis from a workshop conducted at the University of Siegen, in collaboration with the University of Bonn, on September 6-7, 2022."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Ancient DNA Data Analysis - Workshop Uni Siegen 2022",
    "section": "",
    "text": "Welcome to the Website for the “Ancient DNA Data Analysis” workshop."
  },
  {
    "objectID": "index.html#learning-objectives",
    "href": "index.html#learning-objectives",
    "title": "Ancient DNA Data Analysis - Workshop Uni Siegen 2022",
    "section": "Learning objectives",
    "text": "Learning objectives"
  },
  {
    "objectID": "index.html#rstudio-cloud",
    "href": "index.html#rstudio-cloud",
    "title": "Ancient DNA Data Analysis - Workshop Uni Siegen 2022",
    "section": "RStudio-Cloud",
    "text": "RStudio-Cloud\nOur interactive exercises are done in RStudio-Cloud.\nIn order to join our “classroom” workspace, you need to follow this link. Then follow these steps:\n\nClick on “Sign up” to create a free account, or, if you already have an account, simply log in\nIn the workshop space, you should now see “Join Space?” -> Click “YES”\nIn the top menu, click on “Projects”\nYou should see a project named “Ancient_DNA_Workshop_Sept_2022”. Click on “Start” right next to it.\nYou should now see something like this:"
  },
  {
    "objectID": "index.html#local-install",
    "href": "index.html#local-install",
    "title": "Ancient DNA Data Analysis - Workshop Uni Siegen 2022",
    "section": "Local Install",
    "text": "Local Install\nTODO"
  },
  {
    "objectID": "index.html#day-1-tue-sept-6",
    "href": "index.html#day-1-tue-sept-6",
    "title": "Ancient DNA Data Analysis - Workshop Uni Siegen 2022",
    "section": "Day 1, Tue, Sept 6",
    "text": "Day 1, Tue, Sept 6\n\n\n\n\n\n\nNote\n\n\n\nEventually, I will link the slides here, but they are not ready for public yet\n\n\n\n\n\n\n\n\n\nTime\nActivity\n\n\n\n\n13:30 - 15:00\nIntroduction\n\n\n15:00 - 15:30\nCoffee break\n\n\n16:00 - 19:00\nPart 1: Sequencing Data"
  },
  {
    "objectID": "index.html#day-2-wed-sept-7",
    "href": "index.html#day-2-wed-sept-7",
    "title": "Ancient DNA Data Analysis - Workshop Uni Siegen 2022",
    "section": "Day 2, Wed, Sept 7",
    "text": "Day 2, Wed, Sept 7\n\n\n\n\n\n\n\nTime\nActivity\n\n\n\n\n08:30 - 9:30\nPart 2: Neandertals and ghosts\n\n\n9:30 - 10:00\nCoffee break\n\n\n10:00 - 12:00\nPart 2: Neandertals and ghosts (cont.)\n\n\n12:00 - 13:00\nLunch break\n\n\n13:00 - 15:00\nPart 3: Human history during the last 10,000 years"
  },
  {
    "objectID": "materials/01_Intro.html#what-is-archaeogenetics",
    "href": "materials/01_Intro.html#what-is-archaeogenetics",
    "title": "Part 1 - From bones to sequences",
    "section": "What is Archaeogenetics?",
    "text": "What is Archaeogenetics?\n\nGenetic Analysis of prehistoric organic remains\nExamples: bones, teeth, dental calculus, antler, hair, seed, wood, pollen, soil, coprolites"
  },
  {
    "objectID": "materials/01_Intro.html#why-archaeogenetics",
    "href": "materials/01_Intro.html#why-archaeogenetics",
    "title": "Part 1 - From bones to sequences",
    "section": "Why archaeogenetics?",
    "text": "Why archaeogenetics?\n\nWhy are we doing this? Why are prehistoric genetic data important?\nBecause genetic variability in the past can not be derived unambiguously from genetic variability in the presence.\n\n\n\n\n\n\n\nImages by Wolfgang Haak"
  },
  {
    "objectID": "materials/01_Intro.html#sources-of-ancient-dna",
    "href": "materials/01_Intro.html#sources-of-ancient-dna",
    "title": "Part 1 - From bones to sequences",
    "section": "Sources of ancient DNA",
    "text": "Sources of ancient DNA\n\n\n\n\nHuman DNA (Mitochondrial DNA, Nuclear DNA)\n\n\n\n\nPathogen DNA (Bacteria, Viruses, Protists)\n\n\n\n\nEnvironmental DNA (Plants, Funghi, Bacteria, Viruses, Animals)"
  },
  {
    "objectID": "materials/01_Intro.html#what-happens-in-an-ancient-dna-laboratory",
    "href": "materials/01_Intro.html#what-happens-in-an-ancient-dna-laboratory",
    "title": "Part 1 - From bones to sequences",
    "section": "What happens in an ancient DNA laboratory?",
    "text": "What happens in an ancient DNA laboratory?"
  },
  {
    "objectID": "materials/01_Intro.html#from-evolutionary-to-family-history",
    "href": "materials/01_Intro.html#from-evolutionary-to-family-history",
    "title": "Part 1 - From bones to sequences",
    "section": "From evolutionary to family history",
    "text": "From evolutionary to family history\n\n\n\n\n\n\n\nNovembre and Ramachandran 2011, Annu. Rev. Genomics Hum. Genet. 2011."
  },
  {
    "objectID": "materials/01_Intro.html#dna-degradation",
    "href": "materials/01_Intro.html#dna-degradation",
    "title": "Part 1 - From bones to sequences",
    "section": "DNA degradation",
    "text": "DNA degradation\n\n\n\nAncient DNA is short (50-100 bp)\nAncient DNA has chemically changed after death (C->U->T changes at the ends)\nAncient DNA is partly single-stranded (strand breaks)\n\n\n\n\n\n\n\n\n\nImages: Stoneking and Krause 2011, Nat Rev Gen; Wolfgang Haak"
  },
  {
    "objectID": "materials/01_Intro.html#sequencing-data",
    "href": "materials/01_Intro.html#sequencing-data",
    "title": "Part 1 - From bones to sequences",
    "section": "Sequencing Data",
    "text": "Sequencing Data\nThis is how sequencing reads look like on a computer:\n\nsamtools view data/Sample.bam | cut -f10 | head\n\nCGCCCTATTAACCACTCACGGGAGCTCTCCATGCATTTA\nCCTATTAACCACTCACGGGAGCTCTCCATGCATTTGGTATT\nTATTAACCACTCACGGGAGCTCTCCATGCATTTGGTATTTTCGTCTGGGGAGTATGCACGCGATAGCATTGCGAGA\nTATTAACCACTCACGGGAGCTCTCCATACATTTGGTATTTTCGTCTGGGGGGTATGCACGCGATAGCATTGCGAGA\nTCACGGGAGCTCTCCATGCATTTGGTATTTTCGTCTGGGGGGTATGCACGCGATAGCATTGCGAGACGCTGAAGCC\nTCACGGGAGCTCTCCATGCATTTGGTATTTTCGTCTGGGGGGTATGCACGCGATAGCATTGCGAGACGCTGAAGCC\nGAGCTTTTCATGTATTTGGTATTTTCGTCTGGGGGGTATGCACGCGATAGCATTGCGAGATGTTGGA\nTCATGCATTTGGTATTTTCGTCTGGGGGGTATGCACGCGATAGCATTGCGAGACGCT\nATTTGGTATTTTTGTTTGGGGGGTATGCACGCGATAGCATTGCGAG\nCATCTGGGGGGTATGCACACGATAGCATTGCGAGACGCTGGAA\n\n\n\nProblem: Sequencing reads are short, the human genome is long.\n\n\n\n\n\n\n\nNote\n\n\nNote that the samtools view command is used here and introduced later.\n\n\n\n\n\n\n\n\n\nTip\n\n\nIf you’re familiar with the command line, you can try out the command (samtools view ...) yourself. The data is available from this repository."
  },
  {
    "objectID": "materials/01_Intro.html#solution-alignments",
    "href": "materials/01_Intro.html#solution-alignments",
    "title": "Part 1 - From bones to sequences",
    "section": "Solution: Alignments",
    "text": "Solution: Alignments\n\nEvery short fragment gets mapped onto the human genome\nFast mapping algorithms use sophisticated indexing of the human genome to quickly find a matching position\n\n\n\nA typical way to visualise such alignments is shown here:\n\n\n1         11        21        31        41        51        61        71        \nGATCACAGGTCTATCACCCTATTAACCACTCACGGGAGCTCTCCATGCATTTGGTATTTTCGTCTGGGGGGTATGCACGC\n              .G................................................................\n              ,g,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,a       ,a,,,,,,,,,,,,,,,,a,\n                 ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,   ,,,,,,,a,a,,,,,,,,,\n                   ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,a,,,,,,,,,,\n                   ,,,,,,,,,,,,,,,,,,,,,,,,,,,a,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\n                             ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\n                             ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\n                                   .....T.T....T................................\n                                          T.....................................\n                                                ............T..T................\n                                                                        ,,,,,,,,\n                                                                         ,,,,,,,\n                                                                           .....\n\n\n\n\nOr without the reference genome:\n\n\n1         11        21        31        41        51        61        71        \nNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\n              CGCCCTATTAACCACTCACGGGAGCTYTYCATRYATTTRGTATTTTYRTYTGGGRRRTATGCACRC\n              cgccctattaaccactcacgggagctctccatgcattta       catctggggggtatgcacac\n                 cctattaaccactcacgggagctctccatgcatttggtatt   gtctgggagatatgcacgc\n                   tattaaccactcacgggagctctccatgcatttggtattttcgtctggggagtatgcacgc\n                   tattaaccactcacgggagctctccatacatttggtattttcgtctggggggtatgcacgc\n                             tcacgggagctctccatgcatttggtattttcgtctggggggtatgcacgc\n                             tcacgggagctctccatgcatttggtattttcgtctggggggtatgcacgc\n                                   GAGCTTTTCATGTATTTGGTATTTTCGTCTGGGGGGTATGCACGC\n                                          TCATGCATTTGGTATTTTCGTCTGGGGGGTATGCACGC\n                                                ATTTGGTATTTTTGTTTGGGGGGTATGCACGC\n                                                                        atgcacgc\n                                                                         tgcacgc\n                                                                           CACGC\n\n\n\n\n\n\nTop line: Reference genome\nSecond line: Consensus sequence\nOther lines: fragments"
  },
  {
    "objectID": "materials/01_Intro.html#rstudio-cloud",
    "href": "materials/01_Intro.html#rstudio-cloud",
    "title": "Part 1 - From bones to sequences",
    "section": "RStudio Cloud",
    "text": "RStudio Cloud\n\nRStudio is an open source and free platform for data science\nRStudio-Cloud is a browser-based version"
  },
  {
    "objectID": "materials/01_Intro.html#our-turn",
    "href": "materials/01_Intro.html#our-turn",
    "title": "Part 1 - From bones to sequences",
    "section": " Our Turn",
    "text": "Our Turn\n\nGo to our workshop’s website: XXX\nClick on the access link to join our workshop space on RStudio Cloud\nClick on “Sign up” to create a free account, or, if you already have an account, simply log in\nIn the workshop space, you should now see “Join Space?” -> Click “YES”\nIn the top menu, click on “Projects”\nYou should see a project named “Ancient_DNA_Workshop_Sept_2022”. Click on “Start” right next to it.\n\n {width=“200”}"
  },
  {
    "objectID": "presentations/01_Intro.html#what-is-archaeogenetics",
    "href": "presentations/01_Intro.html#what-is-archaeogenetics",
    "title": "Part 1 - From bones to sequences",
    "section": "What is Archaeogenetics?",
    "text": "What is Archaeogenetics?\n\nGenetic Analysis of prehistoric organic remains\nExamples: bones, teeth, dental calculus, antler, hair, seed, wood, pollen, soil, coprolites"
  },
  {
    "objectID": "presentations/01_Intro.html#why-archaeogenetics",
    "href": "presentations/01_Intro.html#why-archaeogenetics",
    "title": "Part 1 - From bones to sequences",
    "section": "Why archaeogenetics?",
    "text": "Why archaeogenetics?\n\nWhy are we doing this? Why are prehistoric genetic data important?\nBecause genetic variability in the past can not be derived unambiguously from genetic variability in the presence.\n\n\n\n\n\n\n\nImages by Wolfgang Haak"
  },
  {
    "objectID": "presentations/01_Intro.html#sources-of-ancient-dna",
    "href": "presentations/01_Intro.html#sources-of-ancient-dna",
    "title": "Part 1 - From bones to sequences",
    "section": "Sources of ancient DNA",
    "text": "Sources of ancient DNA\n\n\n\n\nHuman DNA (Mitochondrial DNA, Nuclear DNA)\n\n\n\n\nPathogen DNA (Bacteria, Viruses, Protists)\n\n\n\n\nEnvironmental DNA (Plants, Funghi, Bacteria, Viruses, Animals)"
  },
  {
    "objectID": "presentations/01_Intro.html#what-happens-in-an-ancient-dna-laboratory",
    "href": "presentations/01_Intro.html#what-happens-in-an-ancient-dna-laboratory",
    "title": "Part 1 - From bones to sequences",
    "section": "What happens in an ancient DNA laboratory?",
    "text": "What happens in an ancient DNA laboratory?"
  },
  {
    "objectID": "presentations/01_Intro.html#from-evolutionary-to-family-history",
    "href": "presentations/01_Intro.html#from-evolutionary-to-family-history",
    "title": "Part 1 - From bones to sequences",
    "section": "From evolutionary to family history",
    "text": "From evolutionary to family history\n\n\n\n\n\n\n\nNovembre and Ramachandran 2011, Annu. Rev. Genomics Hum. Genet. 2011."
  },
  {
    "objectID": "presentations/01_Intro.html#dna-degradation",
    "href": "presentations/01_Intro.html#dna-degradation",
    "title": "Part 1 - From bones to sequences",
    "section": "DNA degradation",
    "text": "DNA degradation\n\n\n\nAncient DNA is short (50-100 bp)\nAncient DNA has chemically changed after death (C->U->T changes at the ends)\nAncient DNA is partly single-stranded (strand breaks)\n\n\n\n\n\n\n\n\n\nImages: Stoneking and Krause 2011, Nat Rev Gen; Christina Warinner"
  },
  {
    "objectID": "presentations/01_Intro.html#sequencing-data",
    "href": "presentations/01_Intro.html#sequencing-data",
    "title": "Part 1 - From bones to sequences",
    "section": "Sequencing Data",
    "text": "Sequencing Data\nThis is how sequencing reads look like on a computer:\n\nsamtools view data/Sample.bam | cut -f10 | head\n\nCGCCCTATTAACCACTCACGGGAGCTCTCCATGCATTTA\nCCTATTAACCACTCACGGGAGCTCTCCATGCATTTGGTATT\nTATTAACCACTCACGGGAGCTCTCCATGCATTTGGTATTTTCGTCTGGGGAGTATGCACGCGATAGCATTGCGAGA\nTATTAACCACTCACGGGAGCTCTCCATACATTTGGTATTTTCGTCTGGGGGGTATGCACGCGATAGCATTGCGAGA\nTCACGGGAGCTCTCCATGCATTTGGTATTTTCGTCTGGGGGGTATGCACGCGATAGCATTGCGAGACGCTGAAGCC\nTCACGGGAGCTCTCCATGCATTTGGTATTTTCGTCTGGGGGGTATGCACGCGATAGCATTGCGAGACGCTGAAGCC\nGAGCTTTTCATGTATTTGGTATTTTCGTCTGGGGGGTATGCACGCGATAGCATTGCGAGATGTTGGA\nTCATGCATTTGGTATTTTCGTCTGGGGGGTATGCACGCGATAGCATTGCGAGACGCT\nATTTGGTATTTTTGTTTGGGGGGTATGCACGCGATAGCATTGCGAG\nCATCTGGGGGGTATGCACACGATAGCATTGCGAGACGCTGGAA\n\n\n\nProblem: Sequencing reads are short, the human genome is long.\n\n\n\n\n\n\n\nNote\n\n\nNote that the samtools view command is used here and introduced later.\n\n\n\n\n\n\n\n\n\nTip\n\n\nIf you’re familiar with the command line, you can try out the command (samtools view ...) yourself. The data is available from this repository."
  },
  {
    "objectID": "presentations/01_Intro.html#solution-alignments",
    "href": "presentations/01_Intro.html#solution-alignments",
    "title": "Part 1 - From bones to sequences",
    "section": "Solution: Alignments",
    "text": "Solution: Alignments\n\nEvery short fragment gets mapped onto the human genome\nFast mapping algorithms use sophisticated indexing of the human genome to quickly find a matching position\n\n\n\nA typical way to visualise such alignments is shown here:\n\n\n1         11        21        31        41        51        61        71        \nGATCACAGGTCTATCACCCTATTAACCACTCACGGGAGCTCTCCATGCATTTGGTATTTTCGTCTGGGGGGTATGCACGC\n              .G................................................................\n              ,g,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,a       ,a,,,,,,,,,,,,,,,,a,\n                 ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,   ,,,,,,,a,a,,,,,,,,,\n                   ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,a,,,,,,,,,,\n                   ,,,,,,,,,,,,,,,,,,,,,,,,,,,a,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\n                             ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\n                             ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,\n                                   .....T.T....T................................\n                                          T.....................................\n                                                ............T..T................\n                                                                        ,,,,,,,,\n                                                                         ,,,,,,,\n                                                                           .....\n\n\n\n\nOr without the reference genome:\n\n\n1         11        21        31        41        51        61        71        \nNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN\n              CGCCCTATTAACCACTCACGGGAGCTYTYCATRYATTTRGTATTTTYRTYTGGGRRRTATGCACRC\n              cgccctattaaccactcacgggagctctccatgcattta       catctggggggtatgcacac\n                 cctattaaccactcacgggagctctccatgcatttggtatt   gtctgggagatatgcacgc\n                   tattaaccactcacgggagctctccatgcatttggtattttcgtctggggagtatgcacgc\n                   tattaaccactcacgggagctctccatacatttggtattttcgtctggggggtatgcacgc\n                             tcacgggagctctccatgcatttggtattttcgtctggggggtatgcacgc\n                             tcacgggagctctccatgcatttggtattttcgtctggggggtatgcacgc\n                                   GAGCTTTTCATGTATTTGGTATTTTCGTCTGGGGGGTATGCACGC\n                                          TCATGCATTTGGTATTTTCGTCTGGGGGGTATGCACGC\n                                                ATTTGGTATTTTTGTTTGGGGGGTATGCACGC\n                                                                        atgcacgc\n                                                                         tgcacgc\n                                                                           CACGC\n\n\n\n\n\n\nTop line: Reference genome\nSecond line: Consensus sequence\nOther lines: fragments"
  },
  {
    "objectID": "presentations/01_Intro.html#rstudio-cloud",
    "href": "presentations/01_Intro.html#rstudio-cloud",
    "title": "Part 1 - From bones to sequences",
    "section": "RStudio Cloud",
    "text": "RStudio Cloud\n\nRStudio is an open source and free platform for data science\nRStudio-Cloud is a browser-based version"
  },
  {
    "objectID": "presentations/01_Intro.html#our-turn",
    "href": "presentations/01_Intro.html#our-turn",
    "title": "Part 1 - From bones to sequences",
    "section": " Our Turn",
    "text": "Our Turn\n\nGo to our workshop’s website: XXX\nClick on the access link to join our workshop space on RStudio Cloud\nClick on “Sign up” to create a free account, or, if you already have an account, simply log in\nIn the workshop space, you should now see “Join Space?” -> Click “YES”\nIn the top menu, click on “Projects”\nYou should see a project named “Ancient_DNA_Workshop_Sept_2022”. Click on “Start” right next to it."
  },
  {
    "objectID": "presentations/01_Intro.html#your-turn",
    "href": "presentations/01_Intro.html#your-turn",
    "title": "Part 1 - From bones to sequences",
    "section": " Your Turn",
    "text": "Your Turn\nOpen a terminal (such as the one included in RStudio or RStudio Cloud), and try out samtools tview yourself by going to the terminal, below, and running samtools tview data/Sample.bam or samtools tview data/Sample.bam --reference data/HG19_MT.fasta. Use your cursors to move left and right, space or Ctrl-L to make bigger jumps to the right, or Ctrl-H for bigger jumps to the left. Type ? to get a quick help, and q to quit."
  },
  {
    "objectID": "presentations/01_Intro.html#your-turn-exercise-1.1",
    "href": "presentations/01_Intro.html#your-turn-exercise-1.1",
    "title": "Part 1 - From bones to sequences",
    "section": " Your Turn (Exercise 1.1)",
    "text": "Your Turn (Exercise 1.1)\n\nMake sure you have access to our RStudio project, as described on the workshop webpage (https://stschiff.github.io/Ancient_DNA_Workshop_Sept_2022/)\nOpen the file exercise_1_1_alignment.txt under presentations.\nEdit the file to visually align the sequencing Reads to the given Reference genome:\nReference_Genome: AACACTTGGTCACTGGGGTTTACACTGGTACACTGGACTACCCTGGGTACACTGACTACGACTACGACTACGTTTACCCCAATTT\nSequencing_Reads:\nGTTTACACTGGTGCACTGGACTACCCTG ACACTGGTGCACTGGACTACCCTGGGTACACTGACTAC TGGTGCACTGGACTACCCTGGGTACACT GACTACCCTGGGTACACTGACTACGA GGTACACTGACTACGACTACGACTACGTT\n\n\n\n\n\n\n\nTip\n\n\nThere may be single basepair mismatches. Find them!"
  },
  {
    "objectID": "presentations/01_Intro.html#your-turn-exercise-1.2",
    "href": "presentations/01_Intro.html#your-turn-exercise-1.2",
    "title": "Part 1 - From bones to sequences",
    "section": " Your Turn (Exercise 1.2)",
    "text": "Your Turn (Exercise 1.2)\n\nClick into the terminal in RStudio\nChange into the presentations directory by typing cd presentations, followed by <Enter>\nRun samtools tview data/Sample.bam\nAlso try samtools tview data/Sample.bam --reference data/HG19_MT.fasta\n\n\n\n\n\n\n\nTip\n\n\n\nUse your cursors to move left and right\nUse space or Ctrl-L to make bigger jumps to the right\nUse or Ctrl-H for bigger jumps to the left.\nType ? to get a quick help\nType q to quit."
  },
  {
    "objectID": "presentations/01_Intro.html#solution-1.1",
    "href": "presentations/01_Intro.html#solution-1.1",
    "title": "Part 1 - From bones to sequences",
    "section": "Solution 1.1",
    "text": "Solution 1.1\n                        Mismatch A -> G               Mismatch G->C\n                             |                             |\n                             |                             |\n                             V                             V\nAACACTTGGTCACTGGGGTTTACACTGGTACACTGGACTACCCTGGGTACACTGACTACGACTACGACTACGTTTACCCCAATTT\n                 GTTTACACTGGTGCACTGGACTACCCTG\n                     ACACTGGTGCACTGGACTACCCTGGGTACACTGACTAC\n                         TGGTGCACTGGACTACCCTGGGTACACT\n                                   GACTACCCTGGGTACACTGACTACCA\n                                             GGTACACTGACTACCACTACGACTACGTT"
  },
  {
    "objectID": "presentations/01_Intro.html#interlude---rstudio-cloud",
    "href": "presentations/01_Intro.html#interlude---rstudio-cloud",
    "title": "Part 1 - From bones to sequences",
    "section": "Interlude - RStudio Cloud",
    "text": "Interlude - RStudio Cloud\n\nRStudio is an open source and free platform for data science\nRStudio-Cloud is a browser-based version"
  },
  {
    "objectID": "presentations/01_Intro.html#next-slide",
    "href": "presentations/01_Intro.html#next-slide",
    "title": "Part 1 - From bones to sequences",
    "section": "Next Slide",
    "text": "Next Slide\n...ACCCAAACTTTGCGCGTATCGCTCAGGTTTAAACACCACACCGGGTTTACATCACTCG...\n\n...ACCCAAACTTTGCGCATTTCGCTCTGCTTTAAACACCACACCGGGTTTACATCACTCG..."
  },
  {
    "objectID": "presentations/01_Intro.html#snp-calling",
    "href": "presentations/01_Intro.html#snp-calling",
    "title": "Part 1 - From bones to sequences",
    "section": "SNP calling",
    "text": "SNP calling\n...ACCCAAACTTTGCGCATATCGCTCTGGTTTAAACACCACACCGGGTTTACATCACTCG...\n         ACTTTGCGCGTAT             ACACCACACCGGGTTT\n             TGCGCGTATCGCT              ACACCGGGTTTACATCA\n                  GTATCGCTCAGGTTTA          CGGGCTTACATCACTCG\n                      CGCTCAGGTTTAAACAC        GCTTACATCACTCG...\n\n\n...ACCCAAACTTTGCGCGTATCGCTCAGGTTTAAACACCACACCGGGTTTACATCACTCG...\n\n...ACCCAAACTTTGCGCATATCGCTCTGGTTTAAACACCACACCGGGTTTACATCACTCG...\n    CCCAAACTTTGCGCATTT    CTGCTTTAAACACCA    GGGTTTACATCACT   \n             TGCGCATTTCGCTCTGCTTT\n                  ATTTCGCTCTGCTT\n\n\n...ACCCAAACTTTGCGCATTTCGCTCTGCTTTAAACACCACACCGGGTTTACATCACTCG..."
  },
  {
    "objectID": "index.html#solutions",
    "href": "index.html#solutions",
    "title": "Ancient DNA Data Analysis - Workshop Uni Siegen 2022",
    "section": "Solutions",
    "text": "Solutions\n\nSolution 1.1"
  },
  {
    "objectID": "exercises/exercise_1_1_alignment.html",
    "href": "exercises/exercise_1_1_alignment.html",
    "title": "Exercise 1.1: Alignment",
    "section": "",
    "text": "Tip\n\n\n\nOpen an empty file in RStudio by clicking on the button with the little white rectangle and the green plus side on the top left of the App, simply selecting “Text file”, and copy paste the Reference genome and the sequences below in. Then use spaces to bring the sequences to the right place along the reference.\n\n\n\nReference_Genome: \nAACACTTGGTCACTGGGGTTTACACTGGTACACTGGACTACCCTGGGTACACTGACTACGACTACGACTACGTTTACCCCAATTT\n\nSequencing_Reads:     \nGTTTACACTGGTGCACTGGACTACCCTG\nACACTGGTGCACTGGACTACCCTGGGTACACTGACTAC\nTGGTGCACTGGACTACCCTGGGTACACT\nGACTACCCTGGGTACACTGACTACGA\nGGTACACTGACTACGACTACGACTACGTT"
  },
  {
    "objectID": "exercises/exercise_1_2_tview.html",
    "href": "exercises/exercise_1_2_tview.html",
    "title": "Exercise 1.2: Visualising BAM files",
    "section": "",
    "text": "Tip\n\n\n\n\nUse your cursors to move left and right\nUse space or Ctrl-L to make bigger jumps to the right\nUse or Ctrl-H for bigger jumps to the left.\nType ? to get a quick help\nType q to quit."
  },
  {
    "objectID": "exercises/exercise_2_1_abba_baba.html",
    "href": "exercises/exercise_2_1_abba_baba.html",
    "title": "Exercise 2.1: Abba Baba test",
    "section": "",
    "text": "A genotype matrix looks conceptually like this:\nSNPs / Individuals -> Ind1 Ind2 Ind3 Ind4 ...\n |\n V\nSnp1                   G    A    A    G   . . .\nSnp2                   G    T    T    C   . . .\nSnp3                   T    A    T    G   . . .\nSnp4                   G    A    A    C   . . .\n .                     .    .    .    .   .\n .                     .    .    .    .     .\n .                     .    .    .    .       .\nWe typically deal with dozens to tens of thousands of individuals, and hundreds of thousands to several million SNPs. In practice, to make this matrix easier computable, it is divided into three files: - A file denoting the list of individuals (i.e. the column names) - A file denoting the list of SNPs (i.e. the row names) - A genotype matrix, containing the actual genotype data.\nLet’s take a look at the individual file first:\n\ncat data/Abba_Baba_dataset/Abba_Baba_dataset.ind\n\nNA12878.SG  F   CEU.SG\nNA19240.SG  F   YRI.SG\nVindijaG1_final_provisional.SG  F   VindijaG1_Neanderthal.SG\nChimp.REF   M   Chimp.REF\n\n\nwhere you see four individuals. In each row, the first column denotes the sample name, the second column the sex, and the third column a group label, which is irrelevant for now. Here is a quick summary for the four:\n\nNA12878.SG is a present-day human from the US (with European ancestry).\nNA19240.SG is a present-day human from Nigeria.\nVindijaG1_final_provisional.SG is a Neanderthaler from Vindija Cave in Croatia, who died approximately 50,000 years ago.\nChimp.REF is the Chimpanzee reference genome.\n\nNext, let’s view the first few SNPs:\n\nhead data/Abba_Baba_dataset/Abba_Baba_dataset.snp\n\nrs3094315   1   2.013e-2    752566  G   A\nrs12124819  1   2.0242e-2   776546  G   A\nrs28765502  1   2.2137e-2   832918  C   T\nrs7419119   1   2.2518e-2   842013  G   T\nrs950122    1   2.272e-2    846864  C   G\nrs113171913 1   2.3436e-2   869303  T   C\nrs13302957  1   2.4116e-2   891021  G   A\nrs59986066  1   2.4183e-2   893462  C   T\nrs112905931 1   2.426e-2    896271  T   C\nrs6696609   1   2.4457e-2   903426  T   C\n\n\nEach row contains a SNP, with an ID (first column), chromosome (second column), position in base-pairs along the chromosome (fourth column), and the two alleles present at this SNP (last two columns).\nLet’s see how many SNPs there are:\n\ncat data/Abba_Baba_dataset/Abba_Baba_dataset.snp | wc -l\n\n 1233013\n\n\nSo around 1.2 million SNPs.\nLet’s now take a look at the genotype file:\n\nhead data/Abba_Baba_dataset/Abba_Baba_dataset.geno\n\n0009\n0099\n0299\n0009\n0090\n0000\n0092\n9999\n9909\n0009\n\n\nHere, we have genotype data encoded in the EIGENSTRAT format, which - in our case - contains the following code:\n\n0 -> Allele 1 (the “alternative allele”)\n2 -> Allele 2 (the “reference allele”)\n9 -> Missing data\n\n\n\n\n\n\n\nNote\n\n\n\nTechnically, the format also contains 1 for heterozygous genotypes, but the data we analyse here is “pseudo-haploid”, so represents only one allele for each individual.\n\n\nExercise: Obviously, the genotype file contains the right number of columns (four) for the four individuals we have. Check that it also contains the right number of rows, i.e. the same number that you obtained above using the wc command."
  },
  {
    "objectID": "exercises/solution_1_1_alignment.html",
    "href": "exercises/solution_1_1_alignment.html",
    "title": "Ancient DNA Data Analysis - Workshop Uni Siegen 2022",
    "section": "",
    "text": "Mismatch A -> G               Mismatch G->C\n                             |                             |\n                             |                             |\n                             V                             V\nAACACTTGGTCACTGGGGTTTACACTGGTACACTGGACTACCCTGGGTACACTGACTACGACTACGACTACGTTTACCCCAATTT\n                 GTTTACACTGGTGCACTGGACTACCCTG\n                     ACACTGGTGCACTGGACTACCCTGGGTACACTGACTAC\n                         TGGTGCACTGGACTACCCTGGGTACACT\n                                   GACTACCCTGGGTACACTGACTACCA\n                                             GGTACACTGACTACCACTACGACTACGTT"
  },
  {
    "objectID": "exercises/exercise_1_3_sex_determination.html",
    "href": "exercises/exercise_1_3_sex_determination.html",
    "title": "Exercise 1.3: Sex determination",
    "section": "",
    "text": "Import the data\n\ndat <- readr::read_tsv(\"data/SexDet.txt\", col_types = \"ciiiiii\")\n\nView it:\n\ndat\n\n# A tibble: 35 × 7\n   Sample   TotalAut TotalX TotalY   NrAut   NrX   NrY\n   <chr>       <int>  <int>  <int>   <int> <int> <int>\n 1 SAMPLE4   1150639  49704  32670 1708520 30367 25196\n 2 SAMPLE8   1150639  49704  32670    8774   156   104\n 3 SAMPLE9   1150639  49704  32670 1299329 46274   341\n 4 SAMPLE12  1150639  49704  32670  867988 30079   216\n 5 SAMPLE13  1150639  49704  32670  541696 19214   122\n 6 SAMPLE14  1150639  49704  32670 2386212 41339 33781\n 7 SAMPLE15  1150639  49704  32670  412062  7074  6077\n 8 SAMPLE17  1150639  49704  32670 1670276 29177 23905\n 9 SAMPLE19  1150639  49704  32670 1599366 27127 21984\n10 SAMPLE22  1150639  49704  32670  259069  9302    64\n# … with 25 more rows\n# ℹ Use `print(n = ...)` to see more rows\n\n\nInteractively explore it, by clicking on “dat” in the “Environment” tab in the upper right pane in RStudio.\nHere is an explanation for the columns:\n\nSample - The name of the sample\nTotalAut - The total number of autosomal positions analysed (chromosomes 1-22)\nTotalX - The total number of X-chromosomal positions analysed\nTotalY - The total number of Y-chromosomal positions analysed\nNrAut - The total number of reads mapping to the autosomal positions\nNrX - The total number of reads mapping to the X-chromosomal positions\nNrY - The total number of reads mapping to the Y-chromosomal positions\n\nLet’s try a first simple plot. We first need to load the ggplot2 library, and while we’re at it, we also load the magrittr library to have the pipe operator %>% available for later:\n\nlibrary(ggplot2)\nlibrary(magrittr)\n\nggplot(dat) + geom_point(aes(x = NrAut, y = NrX))\n\n\n\n\nQuestion: Do you have an idea why there are two lines? Exercise: Play around with this plot. For example, change the code so that you’re plotting NrY (and not NrX) against NrAut, and also NrX vs NrY. Do you understand what you’re seeing?\nOf course, the three categories, X, Y and Autosomes have vastly different sizes. In order to compare the numbers, we need to convert them to something like “average coverage”, which we achieve by normalising the read numbers by the total number of analysed positions in each category. Here is a dataset that adds this normalisation:\n\ndat2 <- dat %>%\n  dplyr::mutate(\n    covAut = NrAut / TotalAut,\n    covX   = NrX   / TotalX,\n    covY   = NrY   / TotalY\n  )\n\nThe number of reads mapping to different chromosomes (the variables starting with Nr) are critically dependant on genomic coverage: The more human fragments have been sequenced, the higher the numbers in these variables.\nWe can now again try our simple plot from above, this time using dat2 and the cov... variables:\n\nggplot(dat2) + geom_point(aes(x = covAut, y = covX))\n\n\n\n\nExercise: Play again with this plot, and change the axes using covAut, covX and covY. Not much has changed, besides the values on the axes, which now reflect genomic coverage instead of total number of reads.\nThere still is the problem that samples have vastly different coverages, simply due to different degrees of preservation and different sequencing depths (and some have undergone capture, some haven’t). How do we make these numbers comparable?\nThe easiest approach is to take the autosomal coverage to normalise the X and Y coverage on.\nFor example, here is the distribution of relative X-coverages:\n\nggplot(dat2) + geom_histogram(aes(x = covX / covAut))\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\nExercise: Plot a second histogram with the relative Y coverage.\nFinally, try to copy the code from the scatter plots above and plot relative X vs. relative Y coverage. Can you identify the males and female samples?"
  }
]